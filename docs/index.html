---

title: timeseries_fastai

keywords: fastai
sidebar: home_sidebar

summary: "This repository aims to implement TimeSeries classification/regression algorithms. It makes extensive use of fastai training methods."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/99_index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Installation">Installation<a class="anchor-link" href="#Installation">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In short, if you have anaconda, execute:</p>
<p><code>$ pip install fastai_timeseries</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Time-Series-Classification-from-Scratch-with-Deep-Neural-Networks:-A-Strong-Baseline">Time Series Classification from Scratch with Deep Neural Networks: A Strong Baseline<a class="anchor-link" href="#Time-Series-Classification-from-Scratch-with-Deep-Neural-Networks:-A-Strong-Baseline">&#182;</a></h2><p>The original paper repo is <a href="https://github.com/cauchyturing/UCR_Time_Series_Classification_Deep_Learning_Baseline">here</a> is implemented in Keras/Tf.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Notebook 01: This is a basic notebook that implements the Deep Learning models proposed in <a href="https://arxiv.org/abs/1611.06455">Time Series Classification from Scratch with Deep Neural Networks: A Strong Baseline</a>. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="InceptionTime:-Finding-AlexNet-for-Time-SeriesClassification">InceptionTime: Finding AlexNet for Time SeriesClassification<a class="anchor-link" href="#InceptionTime:-Finding-AlexNet-for-Time-SeriesClassification">&#182;</a></h2><p>The original paper repo is <a href="https://github.com/hfawaz/InceptionTime">here</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Notebook 02: Added InceptionTime architecture from <a href="https://arxiv.org/pdf/1909.04939.pdf">InceptionTime: Finding AlexNet for Time SeriesClassification</a>. Need to check if the implementation is identical to paper, please comment.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Getting-Started">Getting Started<a class="anchor-link" href="#Getting-Started">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai2.basics</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">timeseries_fastai.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">timeseries_fastai.data</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">timeseries_fastai.models</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ucr_path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">UCR</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ucr_path</span><span class="o">/</span><span class="s1">&#39;St&#39;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path(&#39;/home/tc256760/.fastai/data/Univariate2018_arff/St&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span> <span class="o">=</span> <span class="n">load_df_ucr</span><span class="p">(</span><span class="n">ucr_path</span><span class="p">,</span> <span class="s1">&#39;StarLightCurves&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Loading files from: /home/tc256760/.fastai/data/Univariate2018_arff/StarLightCurves
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">stack_train_valid</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>att1</th>
      <th>att2</th>
      <th>att3</th>
      <th>att4</th>
      <th>att5</th>
      <th>att6</th>
      <th>att7</th>
      <th>att8</th>
      <th>att9</th>
      <th>att10</th>
      <th>...</th>
      <th>att1017</th>
      <th>att1018</th>
      <th>att1019</th>
      <th>att1020</th>
      <th>att1021</th>
      <th>att1022</th>
      <th>att1023</th>
      <th>att1024</th>
      <th>target</th>
      <th>valid_col</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.537303</td>
      <td>0.531103</td>
      <td>0.528503</td>
      <td>0.529403</td>
      <td>0.533603</td>
      <td>0.540903</td>
      <td>0.551103</td>
      <td>0.564003</td>
      <td>0.579603</td>
      <td>0.597603</td>
      <td>...</td>
      <td>0.545903</td>
      <td>0.543903</td>
      <td>0.541003</td>
      <td>0.537203</td>
      <td>0.532303</td>
      <td>0.526403</td>
      <td>0.519503</td>
      <td>0.511403</td>
      <td>b'3'</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.588398</td>
      <td>0.593898</td>
      <td>0.599098</td>
      <td>0.604098</td>
      <td>0.608798</td>
      <td>0.613397</td>
      <td>0.617797</td>
      <td>0.622097</td>
      <td>0.626097</td>
      <td>0.630097</td>
      <td>...</td>
      <td>0.246499</td>
      <td>0.256199</td>
      <td>0.266499</td>
      <td>0.277399</td>
      <td>0.288799</td>
      <td>0.300899</td>
      <td>0.313599</td>
      <td>0.326899</td>
      <td>b'3'</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.049900</td>
      <td>-0.041500</td>
      <td>-0.033400</td>
      <td>-0.025600</td>
      <td>-0.018100</td>
      <td>-0.010800</td>
      <td>-0.003800</td>
      <td>0.003000</td>
      <td>0.009600</td>
      <td>0.015900</td>
      <td>...</td>
      <td>-0.161601</td>
      <td>-0.149201</td>
      <td>-0.136401</td>
      <td>-0.123201</td>
      <td>-0.109701</td>
      <td>-0.095901</td>
      <td>-0.081701</td>
      <td>-0.067100</td>
      <td>b'1'</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.337005</td>
      <td>1.319805</td>
      <td>1.302905</td>
      <td>1.286305</td>
      <td>1.270005</td>
      <td>1.254005</td>
      <td>1.238304</td>
      <td>1.223005</td>
      <td>1.208104</td>
      <td>1.193504</td>
      <td>...</td>
      <td>1.298505</td>
      <td>1.307705</td>
      <td>1.316505</td>
      <td>1.324905</td>
      <td>1.332805</td>
      <td>1.340205</td>
      <td>1.347005</td>
      <td>1.353205</td>
      <td>b'3'</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.769801</td>
      <td>0.775301</td>
      <td>0.780401</td>
      <td>0.785101</td>
      <td>0.789401</td>
      <td>0.793301</td>
      <td>0.796801</td>
      <td>0.799901</td>
      <td>0.802601</td>
      <td>0.805101</td>
      <td>...</td>
      <td>0.744501</td>
      <td>0.747301</td>
      <td>0.750701</td>
      <td>0.754801</td>
      <td>0.759501</td>
      <td>0.765001</td>
      <td>0.771301</td>
      <td>0.778401</td>
      <td>b'3'</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9231</th>
      <td>0.723503</td>
      <td>0.722803</td>
      <td>0.722803</td>
      <td>0.723603</td>
      <td>0.725203</td>
      <td>0.727403</td>
      <td>0.730303</td>
      <td>0.733903</td>
      <td>0.738003</td>
      <td>0.742803</td>
      <td>...</td>
      <td>0.671702</td>
      <td>0.675702</td>
      <td>0.680402</td>
      <td>0.686102</td>
      <td>0.692602</td>
      <td>0.700002</td>
      <td>0.708403</td>
      <td>0.717803</td>
      <td>b'3'</td>
      <td>True</td>
    </tr>
    <tr>
      <th>9232</th>
      <td>0.629604</td>
      <td>0.636304</td>
      <td>0.643404</td>
      <td>0.650704</td>
      <td>0.658304</td>
      <td>0.666204</td>
      <td>0.674304</td>
      <td>0.682504</td>
      <td>0.691004</td>
      <td>0.699604</td>
      <td>...</td>
      <td>0.603804</td>
      <td>0.603204</td>
      <td>0.602104</td>
      <td>0.600404</td>
      <td>0.598204</td>
      <td>0.595404</td>
      <td>0.592004</td>
      <td>0.588104</td>
      <td>b'3'</td>
      <td>True</td>
    </tr>
    <tr>
      <th>9233</th>
      <td>0.602902</td>
      <td>0.604202</td>
      <td>0.605802</td>
      <td>0.607502</td>
      <td>0.609402</td>
      <td>0.611402</td>
      <td>0.613502</td>
      <td>0.615902</td>
      <td>0.618302</td>
      <td>0.620902</td>
      <td>...</td>
      <td>0.544002</td>
      <td>0.549502</td>
      <td>0.555002</td>
      <td>0.560502</td>
      <td>0.566002</td>
      <td>0.571402</td>
      <td>0.576802</td>
      <td>0.582202</td>
      <td>b'1'</td>
      <td>True</td>
    </tr>
    <tr>
      <th>9234</th>
      <td>-0.525899</td>
      <td>-0.532599</td>
      <td>-0.538699</td>
      <td>-0.544299</td>
      <td>-0.549399</td>
      <td>-0.553999</td>
      <td>-0.558199</td>
      <td>-0.561899</td>
      <td>-0.565199</td>
      <td>-0.568099</td>
      <td>...</td>
      <td>-0.339999</td>
      <td>-0.364799</td>
      <td>-0.391999</td>
      <td>-0.421799</td>
      <td>-0.454199</td>
      <td>-0.489399</td>
      <td>-0.527399</td>
      <td>-0.568299</td>
      <td>b'2'</td>
      <td>True</td>
    </tr>
    <tr>
      <th>9235</th>
      <td>-0.224100</td>
      <td>-0.223200</td>
      <td>-0.219900</td>
      <td>-0.214400</td>
      <td>-0.206600</td>
      <td>-0.196800</td>
      <td>-0.185000</td>
      <td>-0.171300</td>
      <td>-0.155800</td>
      <td>-0.138600</td>
      <td>...</td>
      <td>-0.279800</td>
      <td>-0.273400</td>
      <td>-0.268500</td>
      <td>-0.265300</td>
      <td>-0.263800</td>
      <td>-0.264100</td>
      <td>-0.266300</td>
      <td>-0.270600</td>
      <td>b'3'</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>9236 rows × 1026 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([b&#39;3&#39;, b&#39;1&#39;, b&#39;2&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">TSDataLoaders</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x_cols</span><span class="o">=</span><span class="n">x_cols</span><span class="p">,</span> <span class="n">label_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">valid_col</span><span class="o">=</span><span class="s1">&#39;valid_col&#39;</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inception</span> <span class="o">=</span> <span class="n">create_inception</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">vocab</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-10-1e19dbad814c&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>inception <span class="ansi-blue-fg">=</span> create_inception<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> len<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">.</span>vocab<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;create_inception&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">inception</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interp</span> <span class="o">=</span> <span class="n">ClassificationInterpretation</span><span class="o">.</span><span class="n">from_learner</span><span class="p">(</span><span class="n">learn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interp</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}
</div>
 

